{% extends 'navbar.html' %}

{% load static %}


{% block content %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camera Web App</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .results {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            background-color: #f9f9f9;
            width: 100%;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="image-box" align="center" >
        <table>
            <tr>
                <td>
                    <video id="webcam-video" autoplay playsinline controls></video>
                </td>
            </tr>
        </table>
        <button id="snapButton">Take Photo</button>
        <button id="toggleCameraButton">Toggle Camera</button>

        
    </div>
    <div class="results">
        

    </div>
    <script>



     // Variable to keep track of whether the webcam is currently on
     var isCameraOn = false;

     // Function to toggle the webcam on and off
     function toggleCamera() {
         var video = document.getElementById('webcam-video');
         if (isCameraOn) {
             // Stop the webcam stream
             if (video.srcObject) {
                 var tracks = video.srcObject.getTracks();
                 tracks.forEach(function(track) {
                     track.stop();
                 });
                 video.srcObject = null;
                 document.getElementById('fallback-image').style.display = 'block';
             }
             isCameraOn = false;
         } else {
             // Start the webcam
             startWebcam();
             isCameraOn = true;
         }
     }

     // Function to start the webcam and display video inside .image-box
     function startWebcam() {
         navigator.mediaDevices.getUserMedia({ video: true })
             .then(function(stream) {
                 var video = document.getElementById('webcam-video');
                 video.srcObject = stream;
                 document.getElementById('fallback-image').style.display = 'none';
                 document.querySelector('.image-box').appendChild(video); // Append video to .image-box
             })
             .catch(function(err) {
                 console.error('Error accessing the camera: ', err);
                 document.getElementById('fallback-image').style.display = 'block';
             });
     }

     // Function to capture photo
     function capturePhoto() {
         var video = document.getElementById('webcam-video');
         var canvas = document.createElement('canvas');
         canvas.width = video.videoWidth;
         canvas.height = video.videoHeight;
         var context = canvas.getContext('2d');
         context.drawImage(video, 0, 0, canvas.width, canvas.height);
         var imageUrl = canvas.toDataURL('image/png');
         var link = document.createElement('a');
         link.href = imageUrl;
         link.download = 'photo.png';
         document.body.appendChild(link);
         link.click();
         document.body.removeChild(link);
         document.querySelector('.results').textContent = 'This person has a stroke!';

     }

     // Event listener for "Take Photo" button
     document.getElementById('snapButton').addEventListener('click', function() {
         capturePhoto();
     });

     // Event listener for the "Toggle Camera" button
     document.getElementById('toggleCameraButton').addEventListener('click', function() {
         toggleCamera();
     });

     // Start webcam when the page loads
     window.addEventListener('load', function() {
         startWebcam();
     });
    </script>
</body>
</html>





{% endblock %}


{% block scripts %}
<script type="text/javascript" src="{% static 'js/scripts.js' %}"></script>
{% endblock %}